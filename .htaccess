## You should disable Indexes and MultiViews either here or in the
## global config. Symlinks maybe needed for URL rewriting.
#Options -Indexes -MultiViews +FollowSymLinks

## make sure nobody gets the htaccess, README, COPYING or VERSION files
<Files ~ "^([\._]ht|README$|VERSION$|COPYING$)">
    <IfModule mod_authz_host>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_host>
        Order allow,deny
        Deny from all
    </IfModule>
</Files>

## Don't allow access to git directories
<IfModule alias_module>
    RedirectMatch 404 /\.git
</IfModule>



RewriteEngine on

RewriteCond %{QUERY_STRING} "fbclid=" [NC]

RewriteRule (.*) /$1? [R=301,L]

RewriteRule ^_media/(.*)              lib/exe/fetch.php?media=$1  [QSA,L]

RewriteRule ^_detail/(.*)             lib/exe/detail.php?media=$1  [QSA,L]

RewriteRule ^_export/([^/]+)/(.*)     doku.php?do=export_$1&id=$2  [QSA,L]

RewriteRule ^$                        doku.php  [L]

RewriteCond %{REQUEST_FILENAME}       !-f

RewriteCond %{REQUEST_FILENAME}       !-d

RewriteRule (.*)                      doku.php?id=$1  [QSA,L]

RewriteRule ^index.php$               doku.php


RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://neoocean.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://neoocean.net$      [NC]
RewriteCond %{HTTP_REFERER} !^http://www.neoocean.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://www.neoocean.net$      [NC]
RewriteCond %{HTTP_REFERER} !^https://neoocean.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://neoocean.net$      [NC]
RewriteCond %{HTTP_REFERER} !^https://www.neoocean.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://www.neoocean.net$      [NC]

RewriteCond %{HTTP_REFERER} !^http://o.neoocean.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://o.neoocean.net$      [NC]
RewriteCond %{HTTP_REFERER} !^https://o.neoocean.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://o.neoocean.net$      [NC]
RewriteRule .*\.(jpg|jpeg|gif|png|bmp|pdf|gpx)$ - [F,NC]
